# Representação Arquitetural

## Descrição da Estrutura do Sistema

O sistema seguirá uma arquitetura **Cliente-Servidor (Client-Server)**. Esta arquitetura é organizada em um formato de **único repositório (Monorepo)**, que gerencia duas aplicações principais e independentes:

1. **Cliente (Front-end):** Uma aplicação Web de interface do usuário (UI/UX), desenvolvida em **Next.js (React)**.
2.	**Servidor (Back-end):** Uma aplicação de lógica de negócio e dados, desenvolvida em NestJS **(Node.js)**.

O Servidor (Back-end) é implementado como um **Monólito Modular**. Isso significa que é uma aplicação única e coesa, mas internamente organizada em módulos de domínio independentes (ex: denuncias, usuarios, auth), alinhando-se ao padrão de **Arquitetura em Camadas (Layered Architecture)**.

A comunicação entre o Cliente e o Servidor ocorre exclusivamente através de uma interface de API bem definida, seguindo o padrão **REST (Representational State Transfer)**, com troca de dados no formato JSON.

## Justificativa das Tecnologias Adotadas

A escolha pela arquitetura Cliente-Servidor foi uma decisão deliberada para atender aos requisitos funcionais e não funcionais do projeto Guardiões da Universidade.
A justificativa detalhada baseia-se nos seguintes pilares:
1.	**Separação Estrita de Responsabilidades:** Esta é a principal vantagem. A arquitetura permite uma divisão clara entre a **camada de apresentação (Cliente)** e **a camada de lógica de negócio (Servidor)**.
    - **Front-end (Next.js)**: Foca exclusivamente na experiência do usuário (UX) e na interface (UI). Isso é crucial para atender aos Requisitos Não Funcionais de Usabilidade, como “*Interface Intuitiva*” e “*Responsividade*”. O front-end não contém regras de negócio ou acesso direto ao banco de dados.
    - **Back-end (NestJS)**: Foca exclusivamente na segurança, regras de negócio e persistência de dados. Isso é vital para cumprir os requisitos de “*Segurança e Privacidade*”, como Criptografia de Senhas, e “*Conformidade Legal*”, como a Lei Geral de Proteção de Dados Pessoais (LGPD).

2.	**Flexibilidade Tecnológica e Foco:** A separação permite escolher a melhor ferramenta para cada trabalho.
    - **Next.js** foi escolhido para o front-end por sua alta performance na renderização de interfaces React e seu ecossistema robusto, atendendo ao requisito de “*Responsividade*”.
    - **NestJS** foi escolhido para o back-end por ser um framework opinativo e modular, que força uma organização de código limpa (Controllers, Services), facilitando a manutenção, evolução e a implementação de padrões de segurança.

3. **Desenvolvimento Paralelo e Manutenibilidade:**
    - Com a **API REST** servindo como um "contrato" fixo entre as duas partes (back-end e front-end), a equipe pode trabalhar em paralelo sem bloquear uma à outra, otimizando o tempo de desenvolvimento.
    - A organização do back-end em um **Monólito Modular** foi preferida em vez de microserviços. Para o escopo atual do projeto, outras arquiteturas mais complexas como microserviços introduziriam uma complexidade operacional desnecessária (gerenciamento de múltiplos serviços, comunicação em rede, etc.). O monólito modular oferece uma excelente separação lógica de domínios (ex: módulo de denuncias, módulo de auth), garantindo a qualidade do código sem a sobrecarga de um sistema distribuído.

4.	**Escalabilidade Independente:** A arquitetura permite que o servidor e o cliente sejam escalados de forma independente. Se a plataforma receber um grande número de denúncias, podemos escalar apenas a aplicação back-end para lidar com mais requisições, sem afetar a aplicação front-end.

## Especificação Técnica

A arquitetura Cliente-Servidor do sistema "*Guardiões da Universidade*" é composta por três componentes principais: o Cliente (Front-end), o Servidor (Back-end) e o Banco de Dados. A aplicação é desenvolvida em um formato de Monorepo, que aloja as aplicações do Cliente e do Servidor no mesmo repositório, facilitando o desenvolvimento e o compartilhamento de tipos.
### Componentes da Arquitetura:
1.	**Cliente (Front-end):**
    - **Tecnologia: Next.js (React)**.
    - **Responsabilidade:** Camada de apresentação, sendo a única interface direta com o usuário. É responsável por renderizar todas as telas, gerenciar o estado da interface (UI/UX) e lidar com a interação do usuário, não contém lógica de negócio crítica. Suas funções incluem atender aos requisitos de “*Usabilidade*”, como “*interface intuitiva*” e “*responsividade*”. A comunicação com o back-end é realizada via protocolos HTTP, utilizando Axios para requisições.
    - **Instanciação:** Representa a aplicação front-end localizada na pasta `/Front` do repositório.

2.	**Servidor (back-end):**
    - **Tecnologia: NestJS (Node.js)**.
    - **Responsabilidade:** É o núcleo da aplicação, responsável por toda a lógica de negócio, segurança e persistência de dados. Ele implementa a **API REST** consumida pelo usuário e segue internamente um padrão de **Arquitetura em Camadas** (Controllers, Services, Model) para garantir a separação de responsabilidades e atender ao requisito de “*Manutenção e Evolução*”. É também responsável por implementar todos os requisitos funcionais e de segurança, incluindo **criptografia de senhas**
    - **Instanciação:** Representa a aplicação contida na pasta `/Back` do repositório, organizada em módulos conforme a arquitetura definida.

3.	**Banco de Dados (Database):**
    - **Tecnologia: PostgreSQL**, acessado por meio do ORM **Prisma**.
    - **Responsabilidade:** É a camada de **persistência de dados**. É responsável por armazenar e recuperar todas as informações, incluindo usuários, denúncias, comentários, entre outros. O **Prisma ORM** garante o acesso tipado, seguro e consistente aos dados, facilitando a manutenção e reduzindo a possibilidade de erros.

**Comunicação:**
A comunicação entre o Cliente e o Servidor é feita exclusivamente através de uma **API REST** sobre o protocolo **HTTP**, usando Axios. O Cliente (Next.js) envia requisições HTTP (GET, POST, PATCH, DELETE) para os endpoints definidos no Servidor (NestJS). O Servidor processa a requisição, interage com o Banco de Dados (se necessário) e retorna uma resposta no formato **JSON**.

![Comunicação-Cliente-Servidor](../assets/images/LogoCorujudaOutline.svg){ width="200" }

## Tecnologias Utilizadas

O sistema Guardiões da Universidade utiliza um conjunto de tecnologias modernas focadas em escalabilidade, separação de responsabilidades e uma experiência de desenvolvimento robusta e manutenível:

### Ferramentas Comuns:
- **GitHub**: Utilizado para o versionamento do código-fonte, seguindo uma estratégia de **Monorepo** que aloja os códigos do Back-end e Front-end em um único repositório.
- **Zenhub**: Plataforma de gerenciamento de projetos integrada ao GitHub. É utilizada para organizar o Backlog do Produto, planejar as Sprints (Milestones) e acompanhar o fluxo de trabalho da equipe no Quadro de Tarefas.
- **Jest**: (Conforme planejamento de Sprints) Framework de testes de JavaScript, utilizado para a criação de testes unitários e de integração, garantindo o cumprimento do requisito de testes (RNF 4.3).

**Design e Front-end:**
-	**Figma**: Ferramenta de design colaborativo utilizada para a prototipação de baixa e alta fidelidade das telas (UI), planejamento visual do roadmap e criação de diagramas de arquitetura.
-	**Next.js**: O framework React escolhido para o desenvolvimento do **Cliente (front-end)**. É responsável por toda a camada de apresentação (UI), gerenciamento de estado da interface e o roteamento das páginas.
-	**React**: Biblioteca JavaScript fundamental para a construção de interfaces de usuário componentizadas e reativas.
-	**Axios/Fetch**: Clientes HTTP utilizados no front-end para realizar a comunicação e o consumo da API REST exposta pelo back-end.

**Back-end**
-	**NestJS**: Framework Node.js robusto e modular escolhido para a construção do **Servidor (back-end)**. Ele organiza a lógica de negócio em uma Arquitetura em Camadas (Controllers, Services).
-	**Prisma**: ORM (Object-Relational Mapper) moderno, utilizado para fazer a interface segura e tipada entre a aplicação NestJS e o banco de dados PostgreSQL.
-	**PostgreSQL**: Banco de dados relacional escolhido para a persistência e armazenamento de todos os dados da aplicação, como usuários, denúncias e comentários.
-	**JWT (JSON Web Tokens)**: Padrão utilizado para a autenticação e autorização da API. Garante que endpoints protegidos só possam ser acessados por usuários autenticados.
-	**Bcrypt**: Biblioteca para hashing de senhas, garantindo que as senhas dos usuários sejam armazenadas de forma criptografada e segura, em conformidade com o requisito de segurança (RNF 4.5).

## Metas e restrições arquiteturais

As metas e restrições arquiteturais são derivadas diretamente dos Requisitos Não Funcionais (RNFs) definidos no documento de requisitos do projeto. Eles atuam como diretrizes e restrições que moldam as escolhas de design e tecnologia.
**Metas Arquiteturais (baseadas nos RNFs):**
-	**Usabilidade**:
    -	A arquitetura do front-end deve permitir a criação de uma interface intuitiva onde os fluxos críticos (ex: denúncia, cadastro) sejam realizados em até **4 passos**.
    -	O sistema deve ser **totalmente responsivo**, adaptando-se a desktops, tablets e dispositivos móveis.
-	**Manutenção e Evolução:**
    -	O código-fonte deve seguir padrões de **clean code** para ser legível e fácil de manter.
    -	A arquitetura deve ser claramente documentada, com **documentação clara de endpoints**, fluxos e arquitetura.
-	**Segurança e Conformidade Legal:**
    -	A arquitetura deve garantir que todas as senhas sejam armazenadas usando **hash seguro** (nunca em texto plano).
    -	A arquitetura deve ser compatível com a **LGPD**, garantindo o consentimento do usuário e a capacidade de exclusão de dados.
**Restrições Arquiteturais:**
-	**Tecnologia do Back-end:** O back-end será desenvolvido exclusivamente com o framework **NestJS (Node.js)**.
-	**Tecnologia do Front-end:** O front-end será desenvolvido exclusivamente com o framework **Next.js (React)**.
-	**Banco de Dados:** A camada de persistência utilizará o **PostgreSQL** como sistema de gerenciamento de banco de dados, com o **Prisma** como ORM.

## Backlog do Produto (escopo do produto)

O funcionamento geral do sistema "*Guardiões da Universidade*" é fornecer um canal duplo: um para denúncias e interações da comunidade e outro para orientação formal. Os usuários podem se cadastrar, fazer login, postar denúncias (de forma anônima ou identificada), comentar e reagir a postagens de outros. Em paralelo, podem acessar uma página de orientação com guias e links para os canais oficiais da universidade. Administradores possuem uma interface de gerenciamento para moderar conteúdo e usuários.
Diversos requisitos do backlog influenciaram diretamente a escolha pela arquitetura Cliente-Servidor com um back-end modular:
1.	**Requisitos de Segurança e Domínios Separados:** A necessidade de funcionalidades complexas e seguras, como Autenticação e Conta e Administração , justificou a criação de um back-end robusto (Servidor) para encapsular e proteger essa lógica, separando-a da interface (Cliente).
2.	**Requisitos de Usabilidade:** A forte ênfase em uma Interface Intuitiva e Responsividade justificou o uso de um framework de front-end moderno e dedicado (Next.js), o que é um pilar da arquitetura Cliente-Servidor.
3.	**Requisitos de Manutenibilidade:** O requisito Qualidade do Código influenciou a escolha do NestJS para o back-end, pois sua estrutura modular (conforme visto na estrutura de pastas) permite um monólito modular organizado por domínio, que é mais simples de manter do que microserviços para o escopo deste projeto.
4.	**Experiência da Equipe:** A familiaridade dos integrantes da equipe com o ecossistema JavaScript/TypeScript (NestJS, React, Node.js) foi um fator decisivo, permitindo um desenvolvimento mais rápido e eficiente dentro do prazo acadêmico.

## Visão lógica

A visão lógica descreve a organização interna da aplicação, seus principais componentes de software e como eles interagem. Conforme a arquitetura Cliente-Servidor definida, o sistema é subdividido em dois pacotes de software principais: a aplicação **Cliente (Front-end)** e a aplicação **Servidor (Back-end)**. Esta seção foca primariamente na visão lógica do Servidor (Back-end), que é um **Monólito Modular** construído com NestJS.
**Módulos do Servidor (Back-end):**
O back-end é subdividido em módulos que representam os principais domínios de negócio da aplicação. Esta abordagem garante a separação de responsabilidades e alta manutenibilidade. Os módulos principais são:
-	**app.module.ts:** O módulo raiz que importa todos os outros módulos de funcionalidade.
-	**database (ou prisma):** Módulo de infraestrutura responsável por prover a conexão com o banco de dados (PrismaService) para os outros módulos.
-	**autenticação (ou auth):** Gerencia todas as funcionalidades de autenticação, como registro, login (geração de JWT) e recuperação de senha, além de prover os Guards de segurança.
-	**usuário (ou users):** Gerencia o CRUD de usuários e a lógica de perfis.
-	**denúncias:** Gerencia o CRUD e a lógica de negócio para as denúncias.
-	**categorias:** Gerencia o CRUD dos tipos de denúncia.
-	**comentários:** Gerencia o CRUD de comentários associados às denúncias.
-	**notícias:** Gerencia o CRUD de notícias publicadas por administradores.
-	**apoios:** Gerencia a lógica para "apoiar" denúncias e comentários.
-	**reports:** Gerencia a lógica para "reportar" denúncias e comentários.

**Diagramas e Pacotes**
O diagrama de pacotes a seguir ilustra como os módulos do back-end se relacionam. A principal regra de dependência é que os módulos de funcionalidade dependem do módulo de infraestrutura (database), além de algumas relações de dependências entre eles, a depender do módulo.

UML